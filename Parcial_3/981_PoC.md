#  Reporte de Actividad #981 - Prueba de Concepto (PoC)  
## Simulaci贸n de un Ataque de Inyecci贸n SQL y Mitigaci贸n usando un WAF (ModSecurity)

### Kenny Yaritza Benitez Renteral | 210300510
14/05/2025

El objetivo de esta prueba de concepto es simular un ataque de inyecci贸n SQL en una aplicaci贸n web vulnerable y demostrar c贸mo un Web Application Firewall, en este caso ModSecurity, puede mitigar este tipo de ataque.  
Este es un tema altamente relevante en seguridad de datos, ya que la inyecci贸n SQL est谩 entre las vulnerabilidades m谩s cr铆ticas y comunes del OWASP Top Ten.

Para ello decidi utilizar:
* Docker para realizar los contenedores de Juice Shop, Nginx, ModSecurity.
* OWASP Juice Shop, lo utilice como aplicaci贸n vulnerable para simular el ataque.
* ModSecurity, para que sea la  Web Application Firewall (WAF) para mitigar el ataque.
* Postman, sera la herramienta para realizar pruebas de inyecci贸n SQL.

## Pasos:
### 1. Configuraci贸n del entorno

Se levant贸 el contenedor vulnerable Juice Shop con el siguiente comando:

```bash
docker run --name juice-shop -d -p 3000:3000 bkimminich/juice-shop
```
para despues acceder desde el navegador por medio de :
**[http://localhost:3000/#/](http://localhost:3000/#/)**

Despues cree una imagen personalizada de Nginx con ModSecurity usando Docker.

```Dockerfile
FROM nginx:latest
RUN apt-get update && apt-get install -y libmodsecurity3 libmodsecurity-dev
COPY modsecurity.conf /etc/modsecurity/modsecurity.conf
COPY nginx.conf /etc/nginx/nginx.conf
```

lo trate de ejecutar por medio de:

```bash
docker build -t nginx-modsec-custom .
docker run --name modsec --restart=no -d -p 8080:80 nginx-modsec-custom
```

En teor铆a deberia de poder ingresar por medio de : **[http://localhost:8080](http://localhost:8080)** 
Asi como verse la ventana de Juice Shop protegida por Nginx + ModSecurity.

Sin embargo, en este paso al inicio el navegador mostraba que Nginx se estaba ejecutando correctamente pero que hac铆a falta configuraci贸n adicional para servir Juice Shop.

### Correcciones:

* Se intent贸 modificar los archivos `nginx.conf` y `modsecurity.conf`.
* Se eliminaron y recrearon los contenedores repetidas veces.
* Se ajustaron puertos y vol煤menes.

Apesar de todo, ahora el contenedor de Nginx se enciende y se apaga inmediatamente.
Seg煤n los mensajes de error en logs es debido a que el modulo no esta presente o no fue cargado correctamente.

### Se esperaba poder llevar a cabo las siguientes simulaci贸n de ataque:

 * Inyecci贸n SQL en campos de inicio de sesi贸n
 * Payload utilizado:`' OR 1=1--`
 *  A trav茅s del puerto 3000 que se encuentra sin protecci贸n, simular el ataque con 茅xito y acceder sin credenciales v谩lidas.

Todo esto con el fin de redirigir ese tr谩fico a trav茅s de Nginx con ModSecurity para detectar y mitigar el payload, pero no fue posible probarlo debido a los errores mencionados.
